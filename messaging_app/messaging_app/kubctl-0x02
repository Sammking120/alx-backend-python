#!/bin/bash

echo "ğŸš€ Applying Blue Deployment..."
kubectl apply -f blue_deployment.yaml

echo "ğŸš€ Applying Green Deployment..."
kubectl apply -f green_deployment.yaml

echo "â³ Waiting 10 seconds for pods to start..."
sleep 10

echo "ğŸ” Checking pods..."
kubectl get pods -l app=django

echo "ğŸ“‹ Showing logs from the green deployment:"
GREEN_POD=$(kubectl get pods -l app=django,version=green -o jsonpath="{.items[0].metadata.name}")
kubectl logs $GREEN_POD

echo "âœ… Done. You can switch traffic by editing 'kubeservice.yaml' and re-applying:"
echo "kubectl apply -f kubeservice.yaml"
